$(function(){"use strict";function a(){for(var a,b='<table class="albums"><tr><th>Cover Image</th><th>Artist</th><th>Title</th><th>Label</th><th>playlist</th><th>Options</th></tr>',c=0;m>c;c++)a=d[c],b+="<tr><td>",a.image&&(b+='<img class="albums__cover" src="'+a.image+'" />'),b+="</td><td>"+a.artist+"</td><td>"+a.title+"</td><td>",a.label&&(b+=a.label),b+="</td><td>"+a.playlist+'</td><td><a href="#" class="album__edit" data-aid="'+a.artist_id+'" data-id="'+c+'" >Edit</a></td></tr>';b+="</table>",f.html(b)}function b(a){var b=d[a];console.log(b.playlist),h.val(b.image),i.val(b.artist),j.val(b.title),k.val(b.label),l.val(b.playlist),g.show()}function c(){if(""!==h.val()){if(!h.val().match(n))return alert("invalid image specified"),!1;if(!h.val().match(o))return alert("inavlid url"),!1}return i.val()?j.val()?""===l.val()?(alert("can not have an empty playlist"),!1):l.val().match(o)?!0:(alert("inavlid url"),!1):(alert("album title not specified"),!1):(alert("artist name not specified"),!1)}var d,e,f=$(".results"),g=$(".album-editor"),h=g.find("#cover"),i=g.find("#artist"),j=g.find("#title"),k=g.find("#label"),l=g.find("#playlist"),m=10,n=/\.(jpe?g|png|gif|bmp)$/i,o=/(http:\/\/|https:\/\/)/i;$.ajax("http://www.json-generator.com/api/json/get/cuMdczItsO").done(function(b){d=b.playlist.a,a()});$("body").on("click","a.album__edit",function(a){a.preventDefault(),e=$(this).data("aid"),b($(this).data("id"))}),$(".album-editor").on("submit",function(a){if(a.preventDefault(),c()){var b={image:h.val(),artist:i.val(),title:j.val(),label:k.val(),playlist:h.val()};console.log("data to send",b),$.ajax({url:"http://www.bbc.co.uk/radio1/artist/id/"+e,type:"POST",data:JSON.stringify(b),contentType:"application/json",complete:function(a,b){"error"===b&&(alert("please try again later"),console.log(a))}})}}),$("#editor-close").on("click",function(a){a.preventDefault(),g.hide()})});